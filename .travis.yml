language: java
jobs:
  include:
  - stage: test
  - stage: publish
    if: branch = master && type != pull_request
    env:
    - secure: csJ9j/Y/wCAAcVwptAO45gKpLlJCv8PM/yZZkezH+YsNdkz68+DrQs73uuqZXS4q264Ws2UyV5zJcGaFHli1svGZ1XKIkFssv7XbY1bI2eRGnUb/6wJcfEyGaiJS3mTiRbaBQ/amc/Fj+BxjcLZZyhGKywNj1iWNhKyJgII56vSgDdNckfCXENYt0Mqgqs8rJZUs5/chkXQE08v+D9mp2pkqJLrXDPoNZvOtjBXILW3lr92Dj+4/NLZ8wsXYqMtTrJ1D13+N607iL+NP24Ga/GHLtb2/cPNGE4RwZywxflnSHnDjFLUVC32XWz6slg+SgG0BbQP95a9WY9tNKn9AKukxGGfZ+YLHqZ70wI9Zexu/pGqvRjm8jX32bTwCaip3ZZXirZuwaWwpIVrFDj2pg+cUxnF2SE52/D/XV5ugCK5e721XltUe8zn2m0Ih24cpL4DfHMI6NihaRWkq6GzuZXd1TIwUw9VuySFJSIXOEi0t75Ltu2BQi/LWkhwYpulq3zjsRRAdXJvpu0LuDyU9sQ48Xfa2sd/fAf9Z4f25bBiCW5kjMJSXmZK0RWdBEDJyubsipGu4mRCnQw4JbLb7Q2i11M+jXuv0LKMniszhPGKOoHCZxKUdKzQ3NstV1oLW1kTr1LxDY20ke3CDOSevTJ5WwUU/RWO5MlnAtbVvdbY=
    - secure: krQapBYIMnbUbx5tRWIW33FuvV7lFp7SaiUbf8Sh1s5tsreVnGElz7mn3hWFHRfuJo7ij1zCTzh9mrhVxlPO5P/St2w/BNHmOhS+ZXlUTpZ0As8whhRePdW97mr3BAoQoSaVIV3qm8RGBnfsznIdaEdidk8T293Wt2bqPucsQ9PtZTwOUzshVHvAvPX2l2YII0zBOg0regy5EMdWrvqMVM/bbpBQg9s2rsu211X82XCgMVSU+LaRcG9cpxzFBxkCsDKXrgrdkIs50wuEa7VUoR8jftWCTDfc8dJDbVmLNKl87BL4IvkxRO/4SflH2gEJ9bjOVrAFH9XRzgg2nZxLw444xrh7hX+UXzfybSwDPkSaGBOqQS7fAjqOuxyw2Od5L3+0j9JRbEE4KJb2d4QNix8Biu8+AmGb1c1vdGtNVx1RrZr0OWTGKiBjGuJf6i3BcghTR2pchc3V1+uFhZW8CTE6dW+84m0BxWg2sXutz8pdiBaokO51YbWRkYPoJtPj21uRuwZ26n5RMlTi8L+3zt5lDKVw7hkkSHs3pWFy8SwXXHae50OrzxbO792BOzjsJoDFwJt1PcS8kKysnO5vUj2egNvyH0jaKhPN9DIBUU7habdPs3NtaSBlMh8bx0jKD/N1crm/RwKKRoSDaPaa6gpnc/VaN04DnLLj2ssktig=
    - secure: M82ENXHoS9C6aZylB8hU5GZ+Mwo9ND1uA6Zlqw3YnyX4t7dGWW3mlbo2j+/34jzZGz0g9FYYW/ZHicLtrAxYK6QeN9KlemTVHNvX98oOCBr9d50u5qN+QuMQGLHgNYsrbHU7N8X0kpd/+uD+klqBgK4JiKe5GMO5P42AbndgkW675Rox+eiKvY1TxrETUDNpNjYP7NRvEnzDKF8OSlfo1uH+ydkbPXFszM5hw4GdHJA3/ayEMxn/sRX9R75059MlXjz2+2/eQp20wvRGoYZJzPaSMh1ixpKsYFcP13/idLiF1Z/qznPJgU44leS5/bvVMc/koR21bv689Goq0242YqGVc8P6iI0mkjpjYmFczPdZIk9DOGwJ2+x/M71mTltpBEXBU9NQ66+28PTHDBzVuQGyhaHaj+i0PnJGxr0NgSXl6ozRlRYf64VRAZ5dMc6IIbk293sWPfv3QxqkVneGXjtXaOF2bCBAg4um9DDRhKMaia75Yi3NlZfvWi16hPUN38+Rx1210sGp3vvEGBPsv+Nbzvjl6+L1iDl1O5vxMERxMDFO0D77/AZiDxNGHSqj6kBxodnp2ZLjSjYBI2FDAAJoqXmdQG4FvdcZIoq3MWEUD7WyVMqAqA5Qq2U8LJwJfoTXxCqp0zGMc35tjn/enWuhCAQgF+TJ/JcdOJ3yNik=
    - secure: Xopg2ZVwGXeHdrerdmjaqybMAFR9Z0udYxA6m9mT6GdSwhntziCJpox+y6Q4sUBc63wvpVgb+dZbtitJizId2yKt7OjVRMoefttkmSDAsBQCzrJbwgFeT9AQINDCR+bTR9silqUqxtPM0+kvqjl4+SJMW7bc1h/V5CUAtA+oMtxJ9W6FW4TicOefI2U2Y1MsdnIy63CX6TGRJL+a+MURyJ3TW8pWkGYQlYTugiDm1Rj0vppzYGePhS0p3D1mcTP9qg+7kO7W6JGM7zklDfxBKvaINBt9E8ip9KAtx8ntQdq/bz+WiiNyPlQwLJkGR5D6kWjhc3knZPvgSsbbRY3bi9u5GtJmygizn78E/YPTM3jD+MOsm8ObtxDjO22hHVYNcfxkAVOZvrAgilg6AtjVPmfg16x6NnIkNKvyWfcjdJN/i/MuV53n3+IvYAvuvC50q8mKVebAVuXAQW5uE7Phybq75/ETiOlDYya3PDS/6r3OXdGqvj+zCqiwtKKuK2Egzp7AQeYAbPOebPcutsE07zsK5YgX9w0D/JxwdzNtRBXdALvZ7g6/Ueeju8FgVTVXgXRGLi8+BYvYPmT4I5gjnwvtMrGP4x4ZZnDeRgc5gQzjiFIMmVJ5CSOC3sOxnWF3cPI48ZURIR12epkM2Z6v9bhdC41fYmdX4hALIjPIMzM=
    - secure: BebPh+Uua0wl6ednOy7udfaD3b2Iniuhg/jm03U5zTwwwrmwa3cSr8hFLqwm0rxZA/pVtOS6bVc8EIja1/j6+SaG5YlE4MEoM60eRqUNS0c2L2coS7bF24N+mDjxvdMhp6M4PiAoy4jDRkONvWKgIDI2uIZ8yRpkeyYSof3YqWOsWxfkYqtCURxfhR3ssBMPZNbNj5IQKtzcsl+naGd8oZcTkIESWHaS4btVSzM4rJliC4EUwQn+Pk/8EE2LBsoYcnoY4UMTZnN+BDdluWEfj89wU3R1tjPejA9e9aQ7lRorj67a4zUyIwfdNJ3RjsiZDPXLJDUYo7QhwsoJexNuDByj91jI/fLcDCdN6SK6VxCHgfweGxDLsTTyfqyXOVBvE/f2Sdb2cF6D4XGEizCxwPekcNW5fLo0GhzoBVaZB3c+U6PGfZFxYNbeBssaqkZxsp8RW/3AcRnU1ykLLJ/96F8I/EBcIcsHZeObhLeDoFWi+CGCYw/sci3tSsaT9vxh+8q1mmVsFuQFymYRZYiIfcvTQa+wShLo/ACaX1ElqgdfnNiU5u3d0rdU1FWt9OfBL7nzdvJfHjsF1t62VNGdcoW8defMdpTIVakozi0eiau/ZdfaHgMsdcX+zQfofGySJBteapyg/oK8+2o59pVs3PgfMt0zbQzt8fA18/gelzU=
    - secure: i1xMfynTmISALRtq/wSwe1gGGv/iCa7S2r4bRABv2P2ETqlwNGLQkkNNl/ueLoT66Ny+nHnMMUKiUx8Qt7tdbJcSiqT0hE41UG06LpYhE/lbITp+qYYBRUwRx4dnnZ8BhhrkgOmLvTyW5jkzJQCzBDbPjWKu0CfJ4BlbTwDHvtCsI43XmIjVhvrLu+fve1d/aM8MHDPKp5Bb3Dj+/sUws2QwuUTGxhjOM+TZAmuc+G234tz3LaXBxokTihFJj8FAeRfUwuEGad+vKUPXqBdqgTqDN/zEFY6qpneg7pJMLgrMVDEFHhD0LWhf1CauGV8nW+DecYE7iN1P7koXgjXTmKUBolTpqX+ofcP4ZmhF6dUp8gZRSmRQQEf+oCd6jING66m0MpmwJGG5v7RX9elBxmh2WqpaTonALZeUGQ1hvNa5rIqrcopZUkBY4RyWqgXNpbkMdiWC/gYrO4uCUpqZ4hP8LntHbsGiX6ywBlfoEAqBkunmZvTWnBKNc2uexVvhxeJuFQL6Aan1OJyC5V8F3hN9MVofFM7M0v47D4b92CsVEnmS0JJ3lcrtisdQXIyxijc5SF6YH4EoqezSjXWeVwKZh3DPnSDJmxi8UQr9pseKCsKXVOWYRGsS9/gQpsijNp0zyOVdl9Zk4FZ6nDogZLwvq3XXHl0XWQClXF1RB+Y=
    - secure: CUVBMGYwBvnDD4a7xs1mZZOeCZAcQY5R3ZeBoQTOICSRW0nw+xwFZ348dijI5MrGDic0c0FNT6LmEBv3THvYgdjBCu/WxfVhKQMXBjPRC0DRj+5RDGfpjuJ0WKVa6vTgH7YdP0TX1XgfppgZxd3S6pflFtLQEyEluWVYvKXGawVzfRdbP2TieRI6gqHVqlbHvllaKbnjUsWCx0n3iOvm61khP9LB+IReE6w2SkxsV7mBdoppadmgFwbvyi2GElDKFnB1azay2fUxX/urv+m3jcJvHmGHvcQtvxkoXcjoAg7VDn/dxYxdtfmFXBNjF2wb0qBEcsNJ8tBr300OC56iszhtePaEfVt43n+hIV4HRBFUJM1Tn70uDheyqyYKxwnqBOAbxVf2lXsCChIhQTaBKBAgULdjXpclgjpESXd8WhQJha1vLrZJrFHr9mXkxl9USoAD1s1R/eOvHfdJVQFSo8OK/oA2rHFKNSRJIc1YZ8J9l53PflA0oiU7P5RRwSR1nC59ZkRVEvFP2yNK4R2nlRdfIEv+zho2z6br37p96d3EHx+KEevpT8tCdFq9aKGW9XkAvOF8KNjijxmCYAHi0J55NQlx1bAX0OseOHv2bUE8uWXSoK0R+T8CzPFaeyjRlYKQq3u1uI2gPTODRzMnjj8ehxj6gAX2CkxDps1Atv4=
    script:
    - openssl aes-256-cbc -K $encrypted_ca4550b30397_key -iv $encrypted_ca4550b30397_iv
      -in cicd/secring.gpg.enc -out secring.gpg -d
    - "./gradlew -PrepositoryUser=${USERNAME} -PrepositoryPassword=${PASSWORD} -PrepositoryUrl=${URL}
      -PreleasePath=${RELEASE_PATH} -PsnapshotPath=${SNAPSHOT_PATH} -Psigning.keyId=${GPG_KEY_ID}
      -Psigning.password=${GPG_PASSWORD} publish"

